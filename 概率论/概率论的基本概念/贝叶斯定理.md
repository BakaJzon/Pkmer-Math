---
tags:
  - 数学
dlink:
  - "[[---概率论基本概念---]]"
aliases:
  - Bayes' Theorem
---
贝叶斯定理描述了如何利用现有证据更新某一事件的概率。
$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
$$
其中：
- $P(A|B)$ 是在事件 $B$ 发生的条件下，事件 $A$ 发生的后验概率。在贝叶斯定理中, 也叫[[似然函数|尤度 ]]
- $P(B|A)$ 是在事件 $A$ 发生的条件下，事件 $B$ 发生的条件概率。
- $P(A)$ 是事件 $A$ 的先验概率，即在未考虑事件 $B$ 的情况下，事件 $A$ 发生的概率。
- $P(B)$ 是事件 $B$ 的边缘概率，即事件 $B$ 发生的总概率。


![[Screenshot_20240804_160531_Samsung Notes.jpg]]
 $$\displaystyle P(A_i \mid B) = \frac{P(A_i)\cdot P(B \mid A_i)}{P(B)}$$ 
### 贝叶斯公式的图形表示
#### 全集划分
```tikz
\usepackage{tikz}
\begin{document}
\begin{tikzpicture}
  % 背景全集
  \draw[thick] (0,0) rectangle (5,4) node[below left] {$\Omega$};

  % 圆心与半径
  \coordinate (O) at (2.5,2);
  \def\R{1.3}
  \def\r{0.7}

  % 大圆与等分线
  \draw[thick] (O) circle(\R);
  \foreach \a in {90,-30,-150} {
    \draw[thick] (O) -- ++(\a:\R);
  }

  % 小圆 B
  \draw[thick] (O) circle(\r);

  % A₁ 区域红色横线填充
  \begin{scope}
    \clip (O) -- ++(90:\R) arc[start angle=90,end angle=-30,radius=\R] -- cycle;
    \foreach \y in {-1.0,-0.8,...,4.0} {
      \draw[red, line width=0.6pt] (-1,\y) -- (6,\y);
    }
  \end{scope}

  % B 区域蓝色竖线填充
  \begin{scope}
    \clip (O) circle(\r);
    \foreach \x in {0.0,0.2,...,5.0} {
      \draw[blue, line width=0.6pt] (\x,-1) -- (\x,4);
    }
  \end{scope}

\end{tikzpicture}
\end{document}
```
#### 分解图形
```tikz
\usepackage{tikz}
\begin{document}
\begin{tikzpicture}[scale=1]
% ----------- 全局参数 -----------
\def\R{1.3}      % 外圆半径
\def\r{0.7}      % 内圆半径 (B)
\def\xgap{0.2}   % 列间距
\def\ygap{-2.5}  % 行间距
\def\dx{-2.2}    % 红横线范围
\def\dy{-2.2}    % 蓝竖线范围
% 三个扇形的角度 (逆时针)
\def\aOne{90} \def\aTwo{210}
\def\bOne{210} \def\bTwo{330}
\def\cOne{330} \def\cTwo{90}

% ---------- 第一行：完整扇形 (A_i) ----------
% -------- A1 ----------
\begin{scope}[shift={(0,0)}]
  %--- 红横线 (外环) ---
  \begin{scope}
    \clip ({\R*cos(\aOne)},{\R*sin(\aOne)}) arc (\aOne:\aTwo:\R) -- ({\r*cos(\aTwo)},{\r*sin(\aTwo)}) arc (\aTwo:\aOne:\r) -- cycle;
    \foreach \y in {-2,-1.8,...,2}{\draw[red,thin] (\dx,\y) -- (-\dx,\y);}
  \end{scope}
  %--- 蓝竖线 (交集) ---
  \begin{scope}
    \clip (0,0) -- ({\r*cos(\aOne)},{\r*sin(\aOne)}) arc (\aOne:\aTwo:\r) -- cycle;
    \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
  \end{scope}
  %--- 边界 ---
  \draw[thick] (0,0) -- ({\R*cos(\aOne)},{\R*sin(\aOne)}) arc (\aOne:\aTwo:\R) -- cycle;
  \draw[thick] (0,0) -- ({\r*cos(\aOne)},{\r*sin(\aOne)}) arc (\aOne:\aTwo:\r) -- cycle;
\end{scope}
% -------- A2 ----------
\begin{scope}[shift={(\xgap,0)}]
  \begin{scope}
    \clip ({\R*cos(\bOne)},{\R*sin(\bOne)}) arc (\bOne:\bTwo:\R) -- ({\r*cos(\bTwo)},{\r*sin(\bTwo)}) arc (\bTwo:\bOne:\r) -- cycle;
    \foreach \y in {-2,-1.8,...,2}{\draw[red,thin] (\dx,\y) -- (-\dx,\y);}
  \end{scope}
  \begin{scope}
    \clip (0,0) -- ({\r*cos(\bOne)},{\r*sin(\bOne)}) arc (\bOne:\bTwo:\r) -- cycle;
    \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
  \end{scope}
  \draw[thick] (0,0) -- ({\R*cos(\bOne)},{\R*sin(\bOne)}) arc (\bOne:\bTwo:\R) -- cycle;
  \draw[thick] (0,0) -- ({\r*cos(\bOne)},{\r*sin(\bOne)}) arc (\bOne:\bTwo:\r) -- cycle;
\end{scope}
% -------- A3 ----------
\begin{scope}[shift={(2*\xgap,0)}]
  \begin{scope}
    \clip ({\R*cos(\cOne)},{\R*sin(\cOne)}) arc (\cOne:\cTwo+360:\R) -- ({\r*cos(\cTwo+360)},{\r*sin(\cTwo+360)}) arc (\cTwo+360:\cOne:\r) -- cycle;
    \foreach \y in {-2,-1.8,...,2}{\draw[red,thin] (\dx,\y) -- (-\dx,\y);}
  \end{scope}
  \begin{scope}
    \clip (0,0) -- ({\r*cos(\cOne)},{\r*sin(\cOne)}) arc (\cOne:\cTwo+360:\r) -- cycle;
    \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
  \end{scope}
  \draw[thick] (0,0) -- ({\R*cos(\cOne)},{\R*sin(\cOne)}) arc (\cOne:\cTwo+360:\R) -- cycle;
  \draw[thick] (0,0) -- ({\r*cos(\cOne)},{\r*sin(\cOne)}) arc (\cOne:\cTwo+360:\r) -- cycle;
\end{scope}

% ---------- 第二行：仅内圆 (A_i ∩ B) ----------
% --- A1∩B ---
\begin{scope}[shift={(0,\ygap)}]
  \begin{scope}
    \clip (0,0) -- ({\r*cos(\aOne)},{\r*sin(\aOne)}) arc (\aOne:\aTwo:\r) -- cycle;
    \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
  \end{scope}
  \draw[thick] (0,0) -- ({\r*cos(\aOne)},{\r*sin(\aOne)}) arc (\aOne:\aTwo:\r) -- cycle;
\end{scope}
% --- A2∩B ---
\begin{scope}[shift={(\xgap,\ygap)}]
  \begin{scope}
    \clip (0,0) -- ({\r*cos(\bOne)},{\r*sin(\bOne)}) arc (\bOne:\bTwo:\r) -- cycle;
    \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
  \end{scope}
  \draw[thick] (0,0) -- ({\r*cos(\bOne)},{\r*sin(\bOne)}) arc (\bOne:\bTwo:\r) -- cycle;
\end{scope}
% --- A3∩B ---
\begin{scope}[shift={(2*\xgap,\ygap)}]
  \begin{scope}
    \clip (0,0) -- ({\r*cos(\cOne)},{\r*sin(\cOne)}) arc (\cOne:\cTwo+360:\r) -- cycle;
    \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
  \end{scope}
  \draw[thick] (0,0) -- ({\r*cos(\cOne)},{\r*sin(\cOne)}) arc (\cOne:\cTwo+360:\r) -- cycle;
\end{scope}

% ---------- 第三行：仅外环 (A_i \ B) (已修正) ----------
% ----- A1外 (修正) -----
\begin{scope}[shift={(0,2*\ygap)}]
    % 1. 标准方法：精确剪裁环形区域并填充
    \begin{scope}
        \clip ({\R*cos(\aOne)},{\R*sin(\aOne)}) arc (\aOne:\aTwo:\R) -- ({\r*cos(\aTwo)},{\r*sin(\aTwo)}) arc (\aTwo:\aOne:\r) -- cycle;
        \foreach \y in {-2,-1.8,...,2} {\draw[red,thin] (\dx,\y) -- (-\dx,\y);}
    \end{scope}
    % 2. 绘制边界
    \draw[thick] ({\R*cos(\aOne)},{\R*sin(\aOne)}) arc (\aOne:\aTwo:\R) -- ({\r*cos(\aTwo)},{\r*sin(\aTwo)}) arc (\aTwo:\aOne:\r) -- cycle;
\end{scope}
% ----- A2外 (修正) -----
\begin{scope}[shift={(\xgap,2*\ygap)}]
    \begin{scope}
        \clip ({\R*cos(\bOne)},{\R*sin(\bOne)}) arc (\bOne:\bTwo:\R) -- ({\r*cos(\bTwo)},{\r*sin(\bTwo)}) arc (\bTwo:\bOne:\r) -- cycle;
        \foreach \y in {-2,-1.8,...,2} {\draw[red,thin] (\dx,\y) -- (-\dx,\y);}
    \end{scope}
    \draw[thick] ({\R*cos(\bOne)},{\R*sin(\bOne)}) arc (\bOne:\bTwo:\R) -- ({\r*cos(\bTwo)},{\r*sin(\bTwo)}) arc (\bTwo:\bOne:\r) -- cycle;
\end{scope}
% ----- A3外 (修正) -----
\begin{scope}[shift={(2*\xgap,2*\ygap)}]
    \begin{scope}
        \clip ({\R*cos(\cOne)},{\R*sin(\cOne)}) arc (\cOne:\cTwo+360:\R) -- ({\r*cos(\cTwo+360)},{\r*sin(\cTwo+360)}) arc (\cTwo+360:\cOne:\r) -- cycle;
        \foreach \y in {-2,-1.8,...,2} {\draw[red,thin] (\dx,\y) -- (-\dx,\y);}
    \end{scope}
    \draw[thick] ({\R*cos(\cOne)},{\R*sin(\cOne)}) arc (\cOne:\cTwo+360:\R) -- ({\r*cos(\cTwo+360)},{\r*sin(\cTwo+360)}) arc (\cTwo+360:\cOne:\r) -- cycle;
\end{scope}

\end{tikzpicture}
\end{document}
```
#### 图示关系
```tikz
\usepackage{tikz}
\begin{document}
\begin{tikzpicture}
% ----------- 全局参数 -----------
\def\R{1.3} \def\r{0.7}
\def\dx{-2.2} \def\dy{-2.2}
% 为方便，只用一个扇区 A_1 的角度
\def\angStart{90} \def\angEnd{210}

% ----------- 布局参数 -----------
\def\scl{0.6}  % 全局缩放
\def\hgap{2.5} % 组件的水平中心间隔
\def\vgap{1.4} % 组件的垂直中心间隔

% ==================== LHS: P(A_i|B) ====================
\node at (-4.2, 0) [scale=1.2] {$P(A_i|B)$};
\node at (-2.6, 0) [scale=1.2] {$=$};

% ----------- 第一个分数: (A_i ∩ B) / B -----------
\begin{scope}[shift={(-0.8, 0)}]
    % --- 分子: A_i ∩ B ---
    \begin{scope}[shift={(0,\vgap)}, scale=\scl]
        \begin{scope} % 蓝竖线填充
            \clip (0,0) -- ({\r*cos(\angStart)},{\r*sin(\angStart)}) arc (\angStart:\angEnd:\r) -- cycle;
            \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
        \end{scope}
        \draw[thick] (0,0) -- ({\r*cos(\angStart)},{\r*sin(\angStart)}) arc (\angStart:\angEnd:\r) -- cycle;
    \end{scope}

    % --- 分母: B ---
    \begin{scope}[shift={(0,-\vgap)}, scale=\scl]
        \begin{scope} % 蓝竖线填充
            \clip (0,0) circle (\r);
            \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
        \end{scope}
        \draw[thick] (0,0) circle (\r);
    \end{scope}
    % 分数线
    \draw[thick] (-1.2, 0) -- (1.2, 0);
\end{scope}

% ==================== RHS: [P(A_i)] * [P(B|A_i)] ====================
\node at (1.4, 0) [scale=1.2] {$=$};

% ----------- 第二个分数: P(A_i) = A_i / Ω -----------
\begin{scope}[shift={(1.4 + \hgap, 0)}]
    % --- 分子: A_i ---
    \begin{scope}[shift={(0,\vgap)}, scale=\scl]
        % 红横线 (外环)
        \begin{scope}
            \clip ({\R*cos(\angStart)},{\R*sin(\angStart)}) arc (\angStart:\angEnd:\R) -- ({\r*cos(\angEnd)},{\r*sin(\angEnd)}) arc (\angEnd:\angStart:\r) -- cycle;
            \foreach \y in {-2,-1.8,...,2}{\draw[red,thin] (\dx,\y) -- (-\dx,\y);}
        \end{scope}
        % 蓝竖线 (交集)
        \begin{scope}
            \clip (0,0) -- ({\r*cos(\angStart)},{\r*sin(\angStart)}) arc (\angStart:\angEnd:\r) -- cycle;
            \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
        \end{scope}
        % 边界
        \draw[thick] (0,0) -- ({\R*cos(\angStart)},{\R*sin(\angStart)}) arc (\angStart:\angEnd:\R) -- cycle;
        \draw[thick] (0,0) -- ({\r*cos(\angStart)},{\r*sin(\angStart)}) arc (\angStart:\angEnd:\r) -- cycle;
    \end{scope}
    % --- 分母: Ω (符号已居中) ---
    \begin{scope}[shift={(0,-\vgap)}, scale=\scl]
        \draw[thick] (-\R,-\R) rectangle (\R,\R);
        \node at (0,0) {$\Omega$};
    \end{scope}
    % 分数线
    \draw[thick] (-1.2, 0) -- (1.2, 0);
\end{scope}

% --- 乘号 ---
\node at (1.4 + \hgap + 2.2, 0) [scale=1.5] {$\cdot$};

% ----------- 第三个分数: P(B|A_i) = (A_i ∩ B) / A_i -----------
\begin{scope}[shift={(1.4 + \hgap + 2.2 + \hgap, 0)}]
    % --- 分子: A_i ∩ B ---
    \begin{scope}[shift={(0,\vgap)}, scale=\scl]
        \begin{scope} % 蓝竖线填充
            \clip (0,0) -- ({\r*cos(\angStart)},{\r*sin(\angStart)}) arc (\angStart:\angEnd:\r) -- cycle;
            \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
        \end{scope}
        \draw[thick] (0,0) -- ({\r*cos(\angStart)},{\r*sin(\angStart)}) arc (\angStart:\angEnd:\r) -- cycle;
    \end{scope}
    % --- 分母: A_i ---
    \begin{scope}[shift={(0,-\vgap)}, scale=\scl]
        % 红横线 (外环)
        \begin{scope}
            \clip ({\R*cos(\angStart)},{\R*sin(\angStart)}) arc (\angStart:\angEnd:\R) -- ({\r*cos(\angEnd)},{\r*sin(\angEnd)}) arc (\angEnd:\angStart:\r) -- cycle;
            \foreach \y in {-2,-1.8,...,2}{\draw[red,thin] (\dx,\y) -- (-\dx,\y);}
        \end{scope}
        % 蓝竖线 (交集)
        \begin{scope}
            \clip (0,0) -- ({\r*cos(\angStart)},{\r*sin(\angStart)}) arc (\angStart:\angEnd:\r) -- cycle;
            \foreach \x in {-2,-1.8,...,2}{\draw[blue,thin] (\x,\dy) -- (\x,-\dy);}
        \end{scope}
        % 边界
        \draw[thick] (0,0) -- ({\R*cos(\angStart)},{\R*sin(\angStart)}) arc (\angStart:\angEnd:\R) -- cycle;
        \draw[thick] (0,0) -- ({\r*cos(\angStart)},{\r*sin(\angStart)}) arc (\angStart:\angEnd:\r) -- cycle;
    \end{scope}
    % 分数线
    \draw[thick] (-1.2, 0) -- (1.2, 0);
\end{scope}

\end{tikzpicture}
\end{document}
```



### 推导
贝叶斯定理的推导基于条件概率的定义和全概率公式
$$
P(A|B) = \frac{P(A \cap B)}{P(B)}
$$
$$
P(B|A) = \frac{P(A \cap B)}{P(A)}
$$
由此可以得到：
$$
P(A \cap B) = P(A|B) \cdot P(B)
$$
$$
P(A \cap B) = P(B|A) \cdot P(A)
$$
结合两等式得到：
$$
P(A \cap B) = P(A|B) \cdot P(B) = P(B|A) \cdot P(A)
$$
两边同时除以 $P(B)$，即可得出贝叶斯定理：
$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
$$

> [!warning] 
> 贝叶斯公式不要求各变量独立

## 示例
这是一个极端的例子, 统计了10个人开车,戴表和是否有钱的信息

| 序号  | 开豪车 | 带名表 | 有钱人 |
| --- | --- | --- | --- |
| 1   | 1   | 1   | 1   |
| 2   | 1   | 1   | 1   |
| 3   | 1   | 1   | 1   |
| 4   | 1   | 1   | 1   |
| 5   | 1   | 1   | 1   |
| 6   | 1   | 1   | 1   |
| 7   | 1   | 1   | 1   |
| 8   | 0   | 1   | 0   |
| 9   | 0   | 1   | 0   |
| 10  | 0   | 0   | 0   |

计算 $P(\text{有钱人} | \text{开豪车} \cap \text{带名表})$，即在已知某人同时开豪车和带名表的情况下，这个人是有钱人的概率。

首先，我们可以从数据中统计出相关事件的频次：

1. **开豪车且带名表的人数** ($\text{开豪车} \cap \text{带名表}$)：观察数据中“开豪车”和“带名表”两列同时为 1 的情况。
2. **开豪车且带名表且是有钱人的人数** ($\text{开豪车} \cap \text{带名表} \cap \text{有钱人}$)：观察数据中“开豪车”、“带名表”和“有钱人”三列同时为 1 的情况。

从表中统计：

- **开豪车且带名表** ($\text{开豪车} = 1$ 且 $\text{带名表} = 1$)：一共 7 人（序号 1 到 7）。
- **开豪车且带名表且是有钱人** ($\text{开豪车} = 1$ 且 $\text{带名表} = 1$ 且 $\text{有钱人} = 1$)：也是 7 人（序号 1 到 7）。

现在，我们可以计算条件概率 $P(\text{有钱人} | \text{开豪车} \cap \text{带名表})$：

$$
P(\text{有钱人} | \text{开豪车} \cap \text{带名表}) = \frac{P(\text{开豪车} \cap \text{带名表} \cap \text{有钱人})}{P(\text{开豪车} \cap \text{带名表})}
$$

由于我们看到这两个事件的人数完全一致，因此：

$$
P(\text{有钱人} | \text{开豪车} \cap \text{带名表}) = \frac{7}{7} = 1
$$

这意味着在开豪车且带名表的个体中，他们是有钱人的概率是 100%。

